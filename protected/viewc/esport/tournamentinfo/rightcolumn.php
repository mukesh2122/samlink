<?php	$player = $profile['player'];	$ID_TEAM = $player->ID_TEAM;		$isSignedUp = $profile['isSignedUp'];        	$tournamentinfo = $profile['tournamentinfo'];        $ID_LEAGUE = $tournamentinfo->ID_LEAGUE;	if (empty($tournamentinfo))	{	}	else	{		$TournamentType = $tournamentinfo->TournamentType;		//Show cup matches tree		if ($TournamentType==ESPORT_TOURNAMENTTYPE_CUP)		{			$cup_matchups = Doo::db()->query("SELECT * FROM es_cupmatchups WHERE FK_CUP=$ID_LEAGUE ORDER BY Round,RoundIndex ASC")->fetchall();			echo '<table class="cuptree" width="830px">';			$or = 0;			$colspan = 1;			$participants = Doo::db()->query("SELECT * FROM es_teams")->fetchall();			foreach ($cup_matchups as $cm)			{					$Round = $cm['Round'];					$RoundIndex = $cm['RoundIndex'];					if ($or!=$Round && $or!=0)					{						$colspan *= 2;						echo "</tr>";					}					if ($RoundIndex==0)					{						echo "<tr>";							echo '<td class="cuptree_round">'.$this->__('Round').': '.$Round.'</td>';					}						$ID_MATCHUP = $cm['ID_MATCHUP'];						$FK_PARTICIPANT1 = $cm['FK_PARTICIPANT1'];						$FK_PARTICIPANT2 = $cm['FK_PARTICIPANT2'];						$change1 = 							"var obj = $(this);								var url = site_url + 'esport/ajaxjoincup';								var params = 								{									'ID_TEAM' : this.value,									'ID_MATCHUP' : this.id,									'FK_PARTICIPANT' : this.name								};								$.post(url, params, function(data){																window.location = location.href;								});";															$participant1 = Doo::db()->query("SELECT * FROM es_teams WHERE ID_TEAM=$FK_PARTICIPANT1")->fetchall();						$participant2 = Doo::db()->query("SELECT * FROM es_teams WHERE ID_TEAM=$FK_PARTICIPANT2")->fetchall();						$FK_PARTICIPANTNAME1 = count($participant1)>0 ? $participant1[0]['DisplayName'] : $FK_PARTICIPANT1;						$FK_PARTICIPANTNAME2 = count($participant2)>0 ? $participant2[0]['DisplayName'] : $FK_PARTICIPANT2;						$RoundWinsP1 = $cm['RoundWinsP1'];						$RoundWinsP2 = $cm['RoundWinsP2'];												$s1 = '-';						$s2 = '-';						$bothSignedUp = ($FK_PARTICIPANT1!=0 && $FK_PARTICIPANT2!=0);												$report1 = ($RoundWinsP1+$RoundWinsP2==0 && $bothSignedUp)?'<br/><a href="'.MainHelper::site_url('esport/reportcupmatch/'.$ID_MATCHUP.'/1/0').'">I won</a><a href="'.MainHelper::site_url('esport/reportcupmatch/'.$ID_MATCHUP.'/0/1').'">I lost</a>':'';						$report2 = ($RoundWinsP1+$RoundWinsP2==0 && $bothSignedUp)?'<br/><a href="'.MainHelper::site_url('esport/reportcupmatch/'.$ID_MATCHUP.'/0/1').'">I won</a><a href="'.MainHelper::site_url('esport/reportcupmatch/'.$ID_MATCHUP.'/1/0').'">I lost</a>':'';												//$u1 = ($FK_PARTICIPANT1==0) ? '<input onchange="'.$change1.'" name="FK_PARTICIPANT1" id="'.$ID_MATCHUP.'" size="3" type="text" value=""/>': $FK_PARTICIPANTNAME1;						//$u2 = ($FK_PARTICIPANT2==0) ? '<input onchange="'.$change1.'" name="FK_PARTICIPANT2" id="'.$ID_MATCHUP.'" size="3" type="text" value=""/>': $FK_PARTICIPANTNAME2;						$u1 = ($FK_PARTICIPANT1==0) ? $s1 : $FK_PARTICIPANTNAME1 . (($ID_TEAM==$FK_PARTICIPANT1)?$report1:'');						$u2 = ($FK_PARTICIPANT2==0) ? $s2 : $FK_PARTICIPANTNAME2 . (($ID_TEAM==$FK_PARTICIPANT2)?$report2:'');						echo '<td colspan="'.$colspan.'" style="text-align:center;width:50px;border:1px solid #000;">';						echo '<div class="cuptree_match">'.$u1.'<br/>VS<br/>'.$u2.'<br/>'.$RoundWinsP1.'-'.$RoundWinsP2.'</div>';						echo '</td>';											$or = $Round;			}			echo '</table>';					}		$LeagueName = $tournamentinfo->LeagueName;		$StartTime = $tournamentinfo->StartTime;		$EndTime = $tournamentinfo->EndTime;		$StartTime = date("d-m-Y H:i", $StartTime);		$EndTime = date("d-m-Y H:i", $EndTime);		$EntryFee = $tournamentinfo->EntryFee;		$EntryFee = ($EntryFee==0) ? 'Free' : $EntryFee;		                $credittype = $EntryFee == 0 ? '' : $tournamentinfo->BetType;		$tournamentteams = $profile['tournamentteams'];		$nTeams = count($tournamentteams);		$LeagueSize = $tournamentinfo->LeagueSize;		$ImageName = $tournamentinfo->Image;		$prizePool = $tournamentinfo->Account;		?>		<div class="esports_right_column">			<!-- Header start -->			<div id="news_header">				<img src="<?php echo MainHelper::site_url('global/img/icon.png');?>" alt=""/>				<span><?php echo $this->__('Tournaments'); ?></span>				<span class="pull_right mr10 mt10"><?php echo $profile['gameinfo']->GameName; ?></span>			</div>			<!-- Header end -->                        <?php if(!empty($profile['error'])): ?>                            <div class="esport_infobox esport_widget p10 m10">                                <div>                                    <span class="fcw mr5">                                            <?php echo $this->__($profile['error']); ?>.<br/>                                    </span>                                </div>                            </div>                        <?php endif; ?>			<!-- Tournament information start -->			<div id="tournament_information" class="esport_widget">                        <div class="esport_profile_boxheaders mt0"><p><?php echo $LeagueName ?></p></div>                                <?php $first = substr($ImageName, 0,1);                                      $second = substr($ImageName, 1,1);                                ?>				<a href="#"><img style="width:665px;" src="<?php echo MainHelper::site_url('global/pub_img/esport/'.$first.'/'.$second.'/'.$ImageName);?>"/></a>                                <div id="tournament_information_leftcolumn">                                    <div class="tournament_signup">                                            <span><?php echo $this->__('Signup'); ?></span>                                        <?php if ($isSignedUp == false): ?>                                            <a class="button red" href="<?php echo MainHelper::site_url('esport/signupcup/'.$ID_LEAGUE.'/player');?>"><?php echo $this->__('Player'); ?></a>                                            <?php if($player->hasTeam()): ?>                                                <a class="button red" href="<?php echo MainHelper::site_url('esport/signupcup/'.$ID_LEAGUE).'/team';?>"><?php echo $this->__('Team'); ?></a>                                            <?php endif; ?>                                        <?php else: ?>                                            <a class="button red" href="<?php echo MainHelper::site_url('esport/leavecup/'.$ID_LEAGUE.'/'.$profile['signedTeam']->ID_TEAM);?>"><?php echo $this->__('Unsign'); ?></a>                                        <?php endif; ?>                                    </div>                                </div>				<div class="tournament_information_box mb10">					<ul>						<li><?php echo $this->__('Start time').': '.$StartTime; ?></li>						<li><?php echo $this->__('End time').': '.$EndTime; ?></li>						<li><?php echo $this->__('Type').': '.$TournamentType; ?></li>						<li><?php echo $this->__('Sign-up fee').': '.$EntryFee.' '.$credittype; ?></li>						<li><?php echo $this->__('Prize pool').': '.$prizePool.' '.$credittype; ?></li>						<li><?php echo $this->__('Teams').'/'.$this->__('Max').': '."{$nTeams} / {$LeagueSize}</li>"; ?></li>						<li><?php echo $this->__("General Terms and Conditions").': ';?><a href="#"><?php echo $this->__('Terms and Conditions'); ?></a></li>					</ul>				</div>				<div class="tournament_attendants">					<ul class="attendant_name">						<?php							$leftCol = "";							$rightCol = "";							$i = 0;							foreach ($tournamentteams as $team)							{								$wins = $team['Wins'];								$losses = $team['Losses'];								$nMatch = $wins + $losses;								$pct = ($nMatch>0) ? 100 * $wins / $nMatch : 0;								$pct = round($pct,0);								$c = ($i&1) ? ' class="light"' : '';								$leftCol .= "<li{$c}>{$team['DisplayName']}</li>";								$rightCol .= "<li{$c}>{$pct} % ({$wins} wins / {$losses} losses)</li>";								$i++;							}						?>						<li><?php echo $this->__('Team').' / '.$this->__('Player name'); ?></li>						<?php echo $leftCol; ?>					</ul>					<ul class="attendant_rating">						<li><?php echo $this->__('Rating'); ?></li>						<?php echo $rightCol; ?>					</ul>				</div>                        </div>                          <!--                        <div class="tournament_buttons mr15 mt5">                                        <a class="button red" href="<?php //echo MainHelper::site_url('esport/tournaments'); ?>"><?php //echo $this->__('Back'); ?></a>                        </div>-->			<!-- Tournament information end -->		</div><?php		}?>